<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Spondle • Create Event</title>

  <!-- Tailwind CDN (for quick layout; you can swap for your pipeline) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --bg:#0b0b0b;
      --panel:#121212;
      --text:#e8e8e8;
      --muted:#a5a5a5;
      --accent:#22c55e; /* green */
      --ring:#22c55e66;
      --card:#0f172a;
    }
    html,body{background:#000;color:var(--text)}
    .card{
      background:var(--panel);
      border-radius:14px;
      border:1px solid #1f2937;
    }
    .label{ @apply text-sm text-gray-300 block mb-1; }
    .input{ @apply w-full bg-[#0e0e0e] text-gray-100 rounded-lg border border-gray-700 px-3 py-2 outline-none; }
    .btn{ @apply inline-flex items-center justify-center px-4 py-2 rounded-lg font-medium; }
    .btn-primary{ @apply bg-green-600 hover:bg-green-700 text-white; }
    .btn-secondary{ @apply bg-gray-700 hover:bg-gray-600 text-white; }

    /* Carousel */
    .carousel-wrap{ position:relative }
    .carousel-stage{
      position:relative; overflow:hidden;
      border-radius:14px; border:2px solid transparent;
      transition:border-color .2s, box-shadow .2s;
    }
    .carousel-stage.selected{
      border-color:var(--accent);
      box-shadow:0 0 0 6px var(--ring);
    }
    .carousel-img{
      display:block; width:100%; height:260px; object-fit:cover;
      user-select:none; -webkit-user-drag:none;
      background:#111;
    }
    .arrow{
      position:absolute; top:50%; transform:translateY(-50%);
      width:44px; height:44px; border-radius:9999px;
      background:#111a; backdrop-filter: blur(2px);
      display:flex; align-items:center; justify-content:center;
      border:1px solid #2d2d2d; color:#fff; font-size:20px;
      transition:transform .1s;
    }
    .arrow:active{ transform:translateY(-50%) scale(.96); }
    .arrow-left{ left:12px; }
    .arrow-right{ right:12px; }
    .thumb-row{ display:flex; gap:8px; padding-top:10px; flex-wrap:wrap; }
    .thumb{
      width:64px; height:48px; border-radius:8px; overflow:hidden;
      border:2px solid transparent; cursor:pointer;
    }
    .thumb.selected{ border-color:var(--accent); }
    .thumb img{ width:100%; height:100%; object-fit:cover; display:block; }

    .hint{ color:var(--muted); font-size:.9rem; }
    .section-title{ @apply text-lg font-semibold; }
    .divider{ height:1px; background:#1f2937; margin:18px 0; }
    .tabs .tab{ @apply px-4 py-2 rounded-lg; border:1px solid #263244; }
    .tabs .tab.active{ @apply bg-green-600 text-white border-green-600; }
  </style>
</head>

<body class="min-h-screen">
  <!-- Top bar -->
  <header class="sticky top-0 z-40 border-b border-gray-800 bg-black/70 backdrop-blur">
    <div class="mx-auto max-w-4xl px-4 py-3 flex items-center justify-between">
      <a href="/" class="text-xl font-semibold">Spondle</a>
      <nav class="text-sm text-gray-300">Create Event</nav>
    </div>
  </header>

  <main class="mx-auto max-w-4xl px-4 py-6 space-y-6">
    <form id="eventForm" class="space-y-6">

      <!-- Title & Description -->
      <section class="card p-4 sm:p-6 space-y-4">
        <div>
          <label class="label" for="title">Title</label>
          <input id="title" name="title" class="input" placeholder="Event title">
        </div>
        <div>
          <label class="label" for="description">Description</label>
          <textarea id="description" name="description" rows="4" class="input" placeholder="Tell people about your event"></textarea>
        </div>
      </section>

      <!-- Category -->
      <section class="card p-4 sm:p-6 space-y-4">
        <div>
          <label class="label" for="category">Category</label>
          <select id="category" name="category" class="input">
            <option value="comedy">Comedy</option>
            <option value="music">Music</option>
            <option value="theatre">Theatre</option>
            <option value="sports">Sports</option>
            <option value="family">Family</option>
            <option value="tech">Tech</option>
          </select>
        </div>

        <!-- Stock Image Carousel -->
        <div>
          <div class="flex items-center justify-between">
            <h3 class="section-title">Or choose a stock image</h3>
            <p class="hint">Tap to select. Use arrows to browse.</p>
          </div>

          <div class="carousel-wrap mt-2">
            <div id="carouselStage" class="carousel-stage">
              <img id="carouselImage" class="carousel-img" alt="Event image preview" src="">
              <button type="button" id="prevBtn" class="arrow arrow-left" aria-label="Previous image">‹</button>
              <button type="button" id="nextBtn" class="arrow arrow-right" aria-label="Next image">›</button>
            </div>
            <div id="thumbRow" class="thumb-row"></div>
          </div>

          <!-- Moved here: Image URL field (syncs with selection) -->
          <div class="mt-4">
            <label class="label" for="imageUrl">Image URL</label>
            <input id="imageUrl" name="imageUrl" class="input" placeholder="https://…" />
            <p class="hint mt-1">Selecting a stock image fills this automatically. You can paste your own URL too.</p>
          </div>
        </div>
      </section>

      <!-- Publish / Schedule (kept simple; expand as needed) -->
      <section class="card p-4 sm:p-6 space-y-4">
        <div>
          <label class="label" for="status">Publish Status</label>
          <select id="status" name="status" class="input">
            <option>Draft</option>
            <option>Published</option>
          </select>
        </div>

        <div>
          <label class="label">Schedule</label>
          <div class="tabs flex gap-2">
            <button type="button" class="tab active" data-tab="single">Single</button>
            <button type="button" class="tab" data-tab="recurring">Recurring</button>
            <button type="button" class="tab" data-tab="tour">Tour</button>
          </div>

          <div id="panel-single" class="mt-3">
            <div class="grid sm:grid-cols-2 gap-3">
              <div>
                <label class="label" for="startDate">Start</label>
                <input id="startDate" type="datetime-local" class="input" />
              </div>
              <div>
                <label class="label" for="endDate">End</label>
                <input id="endDate" type="datetime-local" class="input" />
              </div>
            </div>
          </div>

          <div id="panel-recurring" class="hidden mt-3">
            <div class="grid sm:grid-cols-3 gap-3">
              <div>
                <label class="label" for="recStart">Starts</label>
                <input id="recStart" type="date" class="input" />
              </div>
              <div>
                <label class="label" for="recEnd">Ends</label>
                <input id="recEnd" type="date" class="input" />
              </div>
              <div>
                <label class="label" for="recFreq">Frequency</label>
                <select id="recFreq" class="input">
                  <option>Daily</option>
                  <option>Weekly</option>
                  <option>Monthly</option>
                </select>
              </div>
            </div>
          </div>

          <div id="panel-tour" class="hidden mt-3">
            <p class="hint">Add multiple dates/locations here (placeholder UI).</p>
          </div>
        </div>
      </section>

      <!-- Venue (placeholder – keep your existing search if you have one) -->
      <section class="card p-4 sm:p-6 space-y-4">
        <div>
          <label class="label" for="venue">Venue</label>
          <input id="venue" class="input" placeholder="Venue name">
        </div>
        <div class="grid sm:grid-cols-2 gap-3">
          <input class="input" placeholder="City / Town">
          <input class="input" placeholder="Postcode">
        </div>
      </section>

      <!-- Actions -->
      <div class="flex items-center justify-end gap-2">
        <button type="reset" class="btn btn-secondary">Reset</button>
        <button type="submit" class="btn btn-primary">Save Event</button>
      </div>
    </form>
  </main>

  <script>
    /* -----------------------------
       Stock images by category
       ----------------------------- */
    const STOCK = {
      comedy: [
        "https://images.unsplash.com/photo-1521587760476-6c12a4b040da?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1520854221256-17451cc331bf?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?q=80&w=1200&auto=format&fit=crop"
      ],
      music: [
        "https://images.unsplash.com/photo-1519671482749-fd09be7ccebf?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1470225620780-dba8ba36b745?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1499415479124-43c32433a620?q=80&w=1200&auto=format&fit=crop"
      ],
      theatre: [
        "https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1485567723708-63dc5b673907?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1515165562835-c3b8c8f3a3ea?q=80&w=1200&auto=format&fit=crop"
      ],
      sports: [
        "https://images.unsplash.com/photo-1517649763962-0c623066013b?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1461896836934-ffe607ba8211?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1546519638-68e109498ffc?q=80&w=1200&auto=format&fit=crop"
      ],
      family: [
        "https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1520975682031-c1cb190f0d1c?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1494790108377-be9c29b29330?q=80&w=1200&auto=format&fit=crop"
      ],
      tech: [
        "https://images.unsplash.com/photo-1518770660439-4636190af475?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1518779578993-ec3579fee39f?q=80&w=1200&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1518770660439-4636190af475?q=80&w=1200&auto=format&fit=crop"
      ]
    };

    /* -----------------------------
       DOM hooks
       ----------------------------- */
    const categorySelect = document.getElementById('category');
    const carouselStage  = document.getElementById('carouselStage');
    const carouselImage  = document.getElementById('carouselImage');
    const thumbRow       = document.getElementById('thumbRow');
    const prevBtn        = document.getElementById('prevBtn');
    const nextBtn        = document.getElementById('nextBtn');
    const imageUrlInput  = document.getElementById('imageUrl');

    let currentIndex = 0;
    let hasSelection = false; // governs green highlight

    const currentList = () => {
      const key = (categorySelect.value || 'theatre').toLowerCase();
      return STOCK[key] || STOCK['theatre'];
    };

    function renderSlide(){
      const imgs = currentList();
      currentIndex = ((currentIndex % imgs.length) + imgs.length) % imgs.length;
      carouselImage.src = imgs[currentIndex];

      // If you move the slide, the selection is no longer guaranteed.
      // Only keep the green ring WHEN a user explicitly selects.
      if (!hasSelection){
        carouselStage.classList.remove('selected');
      }
      renderThumbs();
    }

    function renderThumbs(){
      const imgs = currentList();
      thumbRow.innerHTML = '';
      imgs.forEach((url, i) => {
        const t = document.createElement('button');
        t.type = 'button';
        t.className = 'thumb' + (hasSelection && i === currentIndex ? ' selected' : '');
        t.innerHTML = `<img alt="" src="${url}">`;
        t.addEventListener('click', () => {
          currentIndex = i;
          selectCurrent(); // explicit selection
        });
        thumbRow.appendChild(t);
      });
    }

    function selectCurrent(){
      const imgs = currentList();
      imageUrlInput.value = imgs[currentIndex];
      hasSelection = true;
      carouselStage.classList.add('selected');   // show green ring
      renderThumbs();                             // reflect thumb selection
    }

    // Arrow navigation (does NOT auto-select)
    prevBtn.addEventListener('click', () => {
      const imgs = currentList();
      currentIndex = (currentIndex - 1 + imgs.length) % imgs.length;
      hasSelection = false;                       // slide ≠ selection
      renderSlide();
    });
    nextBtn.addEventListener('click', () => {
      const imgs = currentList();
      currentIndex = (currentIndex + 1) % imgs.length;
      hasSelection = false;                       // slide ≠ selection
      renderSlide();
    });

    // Tap the big image to select it
    carouselImage.addEventListener('click', selectCurrent);

    // Category change resets carousel & clears selection
    categorySelect.addEventListener('change', () => {
      currentIndex = 0;
      hasSelection = false;
      renderSlide();
    });

    // If user pastes their own URL, preview it and mark as selected (their choice)
    imageUrlInput.addEventListener('change', () => {
      if (!imageUrlInput.value) return;
      carouselImage.src = imageUrlInput.value;
      hasSelection = true;
      carouselStage.classList.add('selected');
      // thumbs remain the same; user has overridden with custom URL
      // (optional: you could clear selected state on thumbs here)
    });

    // Simple tabs
    document.querySelectorAll('.tabs .tab').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        document.querySelectorAll('.tabs .tab').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        const k = btn.dataset.tab;
        ['single','recurring','tour'].forEach(id=>{
          document.getElementById('panel-'+id).classList.toggle('hidden', id!==k);
        });
      });
    });

    // Init
    (function init(){
      // default category may already be selected in the form
      renderSlide();
    })();

    // Demo submit – keep/replace with your real handler
    document.getElementById('eventForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      const data = {
        title:        document.getElementById('title').value,
        description:  document.getElementById('description').value,
        category:     categorySelect.value,
        imageUrl:     imageUrlInput.value,
        status:       document.getElementById('status').value,
        start:        document.getElementById('startDate').value,
        end:          document.getElementById('endDate').value
      };
      console.log('Submit payload', data);
      alert('Event saved (demo). Image URL:\n' + (data.imageUrl || '(none)'));
    });
  </script>
</body>
</html>
