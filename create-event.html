<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Create Event â€“ Spondle (Template)</title>
  <meta name="color-scheme" content="dark" />

  <!-- Tailwind + Flowbite -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.5.1/flowbite.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.5.1/flowbite.min.js"></script>

  <!-- Flowbite Datepicker (for schedule drop-in later) -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite-datepicker/1.3.3/datepicker.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite-datepicker/1.3.3/datepicker.min.js"></script>

  <!-- (Optional) Your global CSS -->
  <link rel="stylesheet" href="./spondle-layout.css?v=global-9">
  <link rel="stylesheet" href="./styles.css?v=global-9">

  <style>
    /* === Lifted 1:1 from image-carousel.html === */
    body { background:#000; color:#fff; font-family:ui-sans-serif,system-ui,sans-serif; min-height:100vh; }
    .card { background:#0f172a; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,.45); }
    .input-dark { background:#0b1220; color:#fff; width:100%; }
    .input-dark::placeholder { color:#9ca3af; }
    .input-dark:focus { border-color:#3b82f6 !important; outline:none; box-shadow:0 0 0 1.5px #3b82f6; }
    /* dashed placeholder panels to mirror your demo look */
    .placeholder-panel { border:1px dashed #374151; background:#0b1220; border-radius:12px; }
  </style>
</head>

<body>
  <!-- Header / Sidebar hooks (if you want them visible on this page) -->
  <header id="spondle-header"></header>

  <main class="max-w-2xl mx-auto px-3 sm:px-6 py-10">
    <form id="create-event-form" class="space-y-6">

      <!-- =========================
           SECTION 1: EVENT BASICS
           ========================= -->
      <section class="card w-full px-3 sm:px-6 py-6" id="card-event-basics">
        <h1 class="text-3xl font-bold text-white mb-6">Event Basics</h1>

        <div class="mb-5">
          <label for="event_name" class="block text-sm text-gray-300 mb-2">Event Name</label>
          <input id="event_name" name="event_name" type="text"
                 class="input-dark p-3 rounded-lg border border-gray-700"
                 placeholder="e.g. Friday Night Comedy" />
        </div>

        <div>
          <label for="description" class="block text-sm text-gray-300 mb-2">Description</label>
          <textarea id="description" name="description" rows="6"
                    class="input-dark p-3 rounded-lg border border-gray-700"
                    placeholder="Tell people what this event is about..."></textarea>
        </div>
      </section>

      <!-- =========================
     ===== IMAGE CAROUSEL START =====
     SECTION 2: IMAGE CAROUSEL (Category + Carousel)
     ===== IMAGE CAROUSEL END =====
     ========================= -->
<section class="card w-full px-3 sm:px-6 py-6" id="card-image-carousel">
  <h2 class="text-3xl font-bold text-white mb-6">Images &amp; Category</h2>

  <div class="mb-6">
    <label for="category" class="block text-sm text-gray-300 mb-2">Event Category &amp; Image</label>
    <select id="category" class="input-dark p-3 rounded-lg border border-gray-700">
      <option value="">Select category</option>
      <option value="music">Music</option>
      <option value="comedy">Comedy</option>
      <option value="theatre">Theatre</option>
      <option value="sports">Sports</option>
      <option value="festival">Festival</option>
      <option value="quiz">Quiz Night</option>
    </select>
  </div>

  <div class="relative w-full">
    <div class="slider-wrapper">
      <div id="slider" class="slider">
        <div class="slide">
          <img src="./images/file_000000002f686243b31639a2bca68eca.png" alt="Placeholder" />
        </div>
      </div>
    </div>

    <button id="prevBtn" class="nav-btn nav-left hidden" aria-label="Previous">&#10094;</button>
    <button id="nextBtn" class="nav-btn nav-right hidden" aria-label="Next">&#10095;</button>
  </div>

  <div id="dots" class="flex items-center justify-center mt-4 min-h-6"></div>
</section>

<script>
  // --- Image Carousel Logic (identical to image-carousel.html) ---
  const IMG_W = 1600, IMG_Q = 70;
  const u = id => `https://images.unsplash.com/photo-${id}?auto=format&fit=crop&w=${IMG_W}&q=${IMG_Q}`;
  const stock = {
    music: [u("1511379938547-c1f69419868d"),u("1506157786151-b8491531f063"),u("1507874457470-272b3c8d8ee2"),u("1470225620780-dba8ba36b745"),u("1497032628192-86f99bcd76bc")],
    comedy: [u("1511671782779-c97d3d27a1d4"),u("1485217988980-11786ced9454"),u("1475724017904-b712052c192a"),u("1515165562835-c3b8c34a47af"),u("1492684223066-81342ee5ff30")],
    theatre: [u("1500530855697-b586d89ba3ee"),u("1485562298395-226cb9c57f45"),u("1442504028989-ab58b5f29a4a"),u("1501785888041-af3ef285b470"),u("1515169067865-5387ec356754")],
    sports: [u("1461896836934-ffe607ba8211"),u("1502877338535-766e1452684a"),u("1505839673365-e3971f8d9184"),u("1521412644187-c49fa049e84d"),u("1508804185872-d7badad00f7d")],
    festival: [u("1533105079780-92b9be482077"),u("1492683513054-55277abccd3c"),u("1500534314209-a25ddb2bd429"),u("1502136969935-8d0710a0d652"),u("1495567720989-cebdbdd97913")],
    quiz: [u("1483721310020-03333e577078"),u("1512428559087-560fa5ceab42"),u("1496307042754-b4aa456c4a2d"),u("1504711434969-e33886168f5c"),u("1514525253161-7a46d19cd819")]
  };

  const catSel=document.getElementById("category"),
        slider=document.getElementById("slider"),
        dots=document.getElementById("dots"),
        prevBtn=document.getElementById("prevBtn"),
        nextBtn=document.getElementById("nextBtn");
  let currentCategory="",currentIndex=0,slides=[];

  function preloadImages(urls){urls.forEach(src=>{const img=new Image();img.src=src;});}
  function renderSlides(images){
    slider.innerHTML="";
    slides=images.map(src=>{
      const div=document.createElement("div");
      div.className="slide";
      const img=document.createElement("img");
      img.src=src; img.alt="Event image";
      div.appendChild(img);
      slider.appendChild(div);
      return div;
    });
    updateSliderPosition();
  }
  function renderDots(count){
    dots.innerHTML="";
    for(let i=0;i<count;i++){
      const dot=document.createElement("span");
      dot.className="dot"+(i===currentIndex?" dot-active":"");
      dot.addEventListener("click",()=>{currentIndex=i;updateSliderPosition();});
      dots.appendChild(dot);
    }
  }
  function updateSliderPosition(){
    slider.style.transform=`translateX(-${currentIndex*100}%)`;
    dots.querySelectorAll(".dot").forEach((d,i)=>d.classList.toggle("dot-active",i===currentIndex));
  }
  function setControlsVisible(v){
    prevBtn.classList.toggle("hidden",!v);
    nextBtn.classList.toggle("hidden",!v);
    dots.classList.toggle("invisible",!v);
  }
  function selectCategory(cat){
    currentCategory=cat; currentIndex=0;
    if(!cat){
      slider.innerHTML=`<div class="slide"><img src="./images/file_000000002f686243b31639a2bca68eca.png" alt="Placeholder" /></div>`;
      setControlsVisible(false); dots.innerHTML="";
      return;
    }
    const imgs=stock[cat];
    preloadImages(imgs);
    renderSlides(imgs);
    renderDots(imgs.length);
    setControlsVisible(true);
  }
  catSel.addEventListener("change",e=>selectCategory(e.target.value));
  prevBtn.addEventListener("click",()=>{
    if(!currentCategory)return;
    currentIndex=(currentIndex-1+slides.length)%slides.length;
    updateSliderPosition();
  });
  nextBtn.addEventListener("click",()=>{
    if(!currentCategory)return;
    currentIndex=(currentIndex+1)%slides.length;
    updateSliderPosition();
  });
  let startX=0;
  slider.addEventListener("touchstart",e=>{startX=e.touches[0].clientX;},false);
  slider.addEventListener("touchend",e=>{
    if(!currentCategory)return;
    const diff=e.changedTouches[0].clientX-startX;
    if(Math.abs(diff)>50){
      if(diff>0)currentIndex=(currentIndex-1+slides.length)%slides.length;
      else currentIndex=(currentIndex+1)%slides.length;
      updateSliderPosition();
    }
  },false);
  selectCategory("");
</script>
    </section>
      

      <!-- =========================
           ===== SCHEDULE START =====
           SECTION 3: SCHEDULE PLACEHOLDER
           (Single / Recurring / Tour will be inserted here)
           ===== SCHEDULE END =====
           ========================= -->
      <section class="card w-full px-3 sm:px-6 py-6" id="card-schedule">
        <h2 class="text-3xl font-bold text-white mb-6">Schedule</h2>
        <div class="placeholder-panel p-6 text-gray-300">
          <p class="mb-2 font-medium text-gray-200">Placeholder</p>
          <p class="text-sm">
            The full <span class="font-semibold">Schedule</span> component (Single / Recurring / Tour) will be inserted here.
          </p>
        </div>
      </section>

      <!-- =========================
           SECTION 4: FINAL SETTINGS
           (Visibility + Publish + Submit)
           ========================= -->
      <section class="card w-full px-3 sm:px-6 py-6" id="card-final-settings">
        <h2 class="text-3xl font-bold text-white mb-6">Final Settings</h2>

        <div class="grid gap-5">
          <div>
            <label for="visibility" class="block text-sm text-gray-300 mb-2">Visibility</label>
            <select id="visibility" name="visibility"
                    class="input-dark p-3 rounded-lg border border-gray-700">
              <option value="public" selected>Public</option>
              <option value="private">Private</option>
            </select>
          </div>

          <div>
            <label for="publish_status" class="block text-sm text-gray-300 mb-2">Publish Status</label>
            <select id="publish_status" name="publish_status"
                    class="input-dark p-3 rounded-lg border border-gray-700">
              <option value="draft" selected>Draft</option>
              <option value="published">Published</option>
            </select>
          </div>

          <div>
            <label class="block text-sm text-gray-300 mb-2">Organiser ID (temporary)</label>
            <input id="organiser_id_display" class="input-dark p-3 rounded-lg border border-gray-700"
                   type="text" value="Loading user..." readonly />
            <input id="organiser_id" name="organiser_id" type="hidden" />
            <p class="text-xs text-gray-400 mt-2">Shown for now; will be hidden/automatic later.</p>
          </div>

          <div class="flex items-center gap-3 pt-2">
            <button id="submitBtn"
                    class="rounded-2xl px-5 py-3 font-medium bg-blue-600 hover:bg-blue-700"
                    type="submit">Submit Event</button>
            <button id="resetBtn"
                    class="rounded-2xl px-5 py-3 font-medium bg-gray-700 hover:bg-gray-600"
                    type="button">Reset</button>
          </div>
        </div>
      </section>
    </form>
  </main>

  <!-- Optional layout script if you want header/sidebar -->
  <script type="module" src="./spondle-layout.js"></script>

  <!-- Supabase for organiser ID display -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL = "https://jvuunvnbpdfrttusgelz.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp2dXVudm5icGRmcnR0dXNnZWx6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0Nzk0NjksImV4cCI6MjA3MzA1NTQ2OX0.i5-X-GsirwcZl0CdAfGsA6qM4ml5itnekPh0RoDCPVY";
    const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    (async () => {
      try {
        const { data: { user }, error } = await supabaseClient.auth.getUser();
        const display = document.getElementById("organiser_id_display");
        const hidden = document.getElementById("organiser_id");

        if (error) {
          console.error(error);
          display.value = "Not signed in";
          return;
        }
        if (user?.id) {
          display.value = user.id;
          hidden.value = user.id;
        } else {
          display.value = "Not signed in";
        }
      } catch (e) {
        console.error(e);
        document.getElementById("organiser_id_display").value = "Error loading user";
      }
    })();

    document.getElementById("create-event-form").addEventListener("submit", (e) => {
      e.preventDefault(); // template-only (no DB writes yet)
      console.log("[Template] Submit clicked.");
    });

    document.getElementById("resetBtn").addEventListener("click", () => {
      document.getElementById("create-event-form").reset();
    });
  </script>
</body>
</html>
