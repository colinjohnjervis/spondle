<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Create Event â€“ Spondle (Template)</title>
  <meta name="color-scheme" content="dark" />

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Flowbite (UI) -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.5.1/flowbite.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.5.1/flowbite.min.js"></script>

  <!-- Flowbite Datepicker (included now so schedule can drop in later) -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite-datepicker/1.3.3/datepicker.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite-datepicker/1.3.3/datepicker.min.js"></script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    /* Minimal helpers only (visual baseline preserved) */
    .card {
      @apply rounded-2xl shadow-md bg-gray-800 px-3 sm:px-6 py-6 mb-6;
    }
    .card-title {
      @apply text-xl font-semibold mb-4;
    }
    .label {
      @apply block text-sm font-medium mb-1;
    }
    .input, .select, .textarea {
      @apply w-full bg-gray-900 border border-gray-700 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500;
    }
    .btn-primary {
      @apply inline-flex items-center justify-center rounded-2xl px-5 py-3 font-medium bg-blue-600 hover:bg-blue-700 disabled:opacity-50;
    }
    .btn-secondary {
      @apply inline-flex items-center justify-center rounded-2xl px-5 py-3 font-medium bg-gray-700 hover:bg-gray-600;
    }
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
  <!-- Header / Sidebar hooks (handled by spondle-layout.js) -->
  <header id="spondle-header"></header>

  <main class="max-w-4xl mx-auto pt-6 pb-16 px-3 sm:px-6">
    <form id="create-event-form" class="space-y-0">
      <!-- =========================
           CARD 1: EVENT BASICS
           ========================= -->
      <section class="card" id="card-event-basics">
        <h2 class="card-title">Event Basics</h2>

        <div class="grid gap-5">
          <!-- Event Name -->
          <div>
            <label for="event_name" class="label">Event Name</label>
            <input id="event_name" name="event_name" type="text" class="input" placeholder="e.g. Friday Night Comedy" />
          </div>

          <!-- Description -->
          <div>
            <label for="description" class="label">Description</label>
            <textarea id="description" name="description" rows="6" class="textarea" placeholder="Tell people what this event is about..."></textarea>
          </div>
        </div>
      </section>

      <!-- =========================
           ===== IMAGE CAROUSEL START =====
           CARD 2: IMAGE CAROUSEL PLACEHOLDER
           (Real carousel + Category will be inserted here later)
           ===== IMAGE CAROUSEL END =====
           ========================= -->
      <section class="card" id="card-image-carousel">
        <h2 class="card-title">Images & Category</h2>
        <div class="rounded-xl border border-dashed border-gray-700 p-6 text-gray-300">
          <p class="mb-2 font-medium">Placeholder</p>
          <p class="text-sm">
            The full <strong>image carousel</strong> (including the <strong>Category</strong> selector) will be inserted here.
          </p>
        </div>
      </section>

      <!-- =========================
           ===== SCHEDULE START =====
           CARD 3: SCHEDULE PLACEHOLDER
           (Single / Recurring / Tour section to drop in here)
           ===== SCHEDULE END =====
           ========================= -->
      <section class="card" id="card-schedule">
        <h2 class="card-title">Schedule</h2>
        <div class="rounded-xl border border-dashed border-gray-700 p-6 text-gray-300">
          <p class="mb-2 font-medium">Placeholder</p>
          <p class="text-sm">
            The full <strong>Schedule</strong> component (Single / Recurring / Tour) will be inserted here.
          </p>
        </div>
      </section>

      <!-- =========================
           CARD 4: FINAL SETTINGS (Visibility + Publish + Submit)
           ========================= -->
      <section class="card" id="card-final-settings">
        <h2 class="card-title">Final Settings</h2>

        <div class="grid gap-5">
          <!-- Visibility -->
          <div>
            <label for="visibility" class="label">Visibility</label>
            <select id="visibility" name="visibility" class="select">
              <option value="public" selected>Public</option>
              <option value="private">Private</option>
            </select>
          </div>

          <!-- Publish Status -->
          <div>
            <label for="publish_status" class="label">Publish Status</label>
            <select id="publish_status" name="publish_status" class="select">
              <option value="draft" selected>Draft</option>
              <option value="published">Published</option>
            </select>
          </div>

          <!-- Organiser (User) ID display -->
          <div class="grid gap-2">
            <label class="label">Organiser ID (temporary)</label>
            <input id="organiser_id_display" class="input" type="text" value="Loading user..." readonly />
            <input id="organiser_id" name="organiser_id" type="hidden" />
            <p class="text-xs text-gray-400">Shown for now; will be hidden/automatic later.</p>
          </div>

          <!-- Actions -->
          <div class="flex items-center gap-3 pt-2">
            <button id="submitBtn" class="btn-primary" type="submit">Submit Event</button>
            <button id="resetBtn" class="btn-secondary" type="button">Reset</button>
          </div>
        </div>
      </section>
    </form>
  </main>

  <!-- Layout / behaviour for header + sidebar etc. -->
  <script type="module" src="./spondle-layout.js"></script>

  <!-- Page Script: minimal wiring only (template mode) -->
  <script>
    // --- Supabase init (kept here so we can evolve into full form later) ---
    const SUPABASE_URL = "https://jvuunvnbpdfrttusgelz.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp2dXVudm5icGRmcnR0dXNnZWx6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0Nzk0NjksImV4cCI6MjA3MzA1NTQ2OX0.i5-X-GsirwcZl0CdAfGsA6qM4ml5itnekPh0RoDCPVY";
    const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // Populate organiser/user id (display + hidden)
    (async () => {
      try {
        const { data: { user }, error } = await supabaseClient.auth.getUser();
        const display = document.getElementById("organiser_id_display");
        const hidden = document.getElementById("organiser_id");

        if (error) {
          display.value = "Not signed in";
          console.error(error);
          return;
        }

        if (user?.id) {
          display.value = user.id;
          hidden.value = user.id;
        } else {
          display.value = "Not signed in";
        }
      } catch (e) {
        console.error(e);
        document.getElementById("organiser_id_display").value = "Error loading user";
      }
    })();

    // Template-only submit handler (no DB writes yet)
    document.getElementById("create-event-form").addEventListener("submit", (e) => {
      e.preventDefault(); // keep template inert
      // Keep visuals unchanged; just a quiet console log for now.
      console.log("[Template] Submit clicked. Wiring to Supabase will be added after carousel & schedule are inserted.");
    });

    // Reset helper
    document.getElementById("resetBtn").addEventListener("click", () => {
      document.getElementById("create-event-form").reset();
    });
  </script>
</body>
</html>
