<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Spondle – Event Details</title>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <link rel="stylesheet" href="styles.css?v=16">
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand"><span class="logo"></span><a href="index.html">Spondle</a></div>
      <div class="actions">
        <a class="btn" href="events.html">Explore Events</a>
        <a class="btn" href="favourites.html">Favourites <span class="badge" data-fav-count style="display:none">0</span></a>
        <a class="btn" href="organisers.html">For Organisers</a>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Event Header -->
    <section class="section">
      <a href="javascript:history.back()" class="muted">← Back</a>
      <h1 id="title" style="margin-top:8px">Event</h1>
      <p id="meta" class="tagline">Loading details…</p>
    </section>

    <!-- Event Content -->
    <section class="section hero-card" id="content">
      <div class="grid" style="grid-template-columns: 1.5fr 1fr;">
        <!-- Left: details -->
        <div id="details">
          <div class="thumb" style="height:220px; display:flex; align-items:flex-end; padding:12px;">
            <span class="badge" id="badge">City • Date</span>
            <span style="margin-left:8px">🎫 <span id="category">Category</span></span>
          </div>

          <div class="content">
            <h3 style="margin-bottom:6px">About this event</h3>
            <p id="desc" class="meta">
              This is a placeholder description. When organisers add a description,
              it will appear here with full details like running order, age limits,
              accessibility, and more.
            </p>

            <div class="row" style="margin-top:14px">
              <span class="chip" id="price">Free</span>
              <span class="muted" id="time">19:30–22:30</span>
              <span class="muted" id="venue">The Venue</span>
            </div>
          </div>
        </div>

        <!-- Right: actions -->
        <aside>
          <div class="hero-card" style="display:grid; gap:10px">
            <button id="favBtn" class="btn" aria-pressed="false" title="Save to favourites">♡ Save</button>
            <button id="shareBtn" class="btn">Share</button>
            <button id="calendarBtn" class="btn" title="Coming soon">Add to Calendar (soon)</button>
            <button id="ticketsBtn" class="btn primary" title="Coming soon">Get Tickets (soon)</button>
          </div>

          <div class="hero-card" style="margin-top:14px">
            <h3 style="margin-bottom:8px">Venue</h3>
            <p class="meta" id="venueBlock">The Venue</p>
          </div>
        </aside>
      </div>
    </section>
  </main>

  <footer>
    <div class="container foot"><div>© <span id="y"></span> Spondle • build v16</div></div>
  </footer>

  <script>document.getElementById('y').textContent = new Date().getFullYear();</script>
  <script src="favs.js?v=16"></script>
  <script>
    // --- Sample data (same IDs as other pages) ---
    const EVENTS = [
      { id:"sample-1", title:"The Harbourside Sessions", city:"Bristol",   dateLabel:"12 Sep", venue:"The Louisiana",    time:"19:30–22:30", price:"Free Entry",   category:"Live Music" },
      { id:"sample-2", title:"Friday Night Laughs",       city:"Manchester",dateLabel:"14 Sep", venue:"Northern Quarter", time:"20:00–22:00", price:"£12",          category:"Comedy" },
      { id:"sample-3", title:"Riverside Street Food",     city:"Cardiff",   dateLabel:"15 Sep", venue:"Market Square",    time:"11:00–17:00", price:"Family",       category:"Community" },
      { id:"sample-4", title:"Craft Beer Festival",       city:"Leeds",     dateLabel:"18 Sep", venue:"City Brewery Hall",time:"12:00–23:00", price:"£20",          category:"Food & Drink" },
      { id:"sample-5", title:"Vintage Vinyl Market",      city:"London",    dateLabel:"20 Sep", venue:"Camden Market",    time:"10:00–18:00", price:"Free Entry",   category:"Market" },
      { id:"sample-6", title:"Outdoor Cinema Night",      city:"Brighton",  dateLabel:"22 Sep", venue:"Brighton Seafront",time:"20:30–23:00", price:"£10",          category:"Film" },
      { id:"sample-7", title:"Tech Meetup & Networking",  city:"Birmingham",dateLabel:"25 Sep", venue:"TechHub Central",  time:"18:00–21:00", price:"Free",         category:"Networking" },
      { id:"sample-8", title:"Charity Fun Run",           city:"Glasgow",   dateLabel:"27 Sep", venue:"Kelvingrove Park", time:"09:00–12:00", price:"£15 Donation", category:"Sports" },
      { id:"sample-9", title:"Open Mic Poetry Night",     city:"Liverpool", dateLabel:"30 Sep", venue:"The Verse Bar",    time:"19:00–22:00", price:"Free Entry",   category:"Arts & Culture" },
    ];
    const mapById = Object.fromEntries(EVENTS.map(e => [e.id, e]));

    // --- Helpers ---
    function getParam(name){
      const url = new URL(location.href);
      return url.searchParams.get(name);
    }

    function setText(id, value){
      const el = document.getElementById(id);
      if (el) el.textContent = value || "";
    }

    // --- Render ---
    const id = getParam("id");
    const ev = mapById[id];

    (function render(){
      if (!ev) {
        document.getElementById("title").textContent = "Event not found";
        document.getElementById("meta").textContent = "This event may have been removed.";
        document.getElementById("content").style.display = "none";
        return;
      }

      document.getElementById("title").textContent = ev.title;
      document.getElementById("meta").textContent = `${ev.city} • ${ev.dateLabel} • ${ev.category}`;
      setText("category", ev.category);
      setText("price", ev.price || "Free");
      setText("time", ev.time || "");
      setText("venue", ev.venue || "");
      setText("venueBlock", ev.venue || "");
      setText("badge", `${ev.city || ""} • ${ev.dateLabel || ""}`);

      // Favourite button
      const favBtn = document.getElementById("favBtn");
      const favNow = Favs.has(ev.id);
      favBtn.setAttribute("aria-pressed", favNow ? "true" : "false");
      favBtn.textContent = favNow ? "♥ Saved" : "♡ Save";
      favBtn.addEventListener("click", ()=>{
        const now = Favs.toggle(ev.id);
        favBtn.setAttribute("aria-pressed", now ? "true" : "false");
        favBtn.textContent = now ? "♥ Saved" : "♡ Save";
      });

      // Share button
      const shareBtn = document.getElementById("shareBtn");
      shareBtn.addEventListener("click", async ()=>{
        const shareData = {
          title: ev.title,
          text: `${ev.title} — ${ev.venue || ""} • ${ev.city || ""} • ${ev.dateLabel || ""}`,
          url: location.href
        };
        if (navigator.share) {
          try { await navigator.share(shareData); } catch(e){}
        } else {
          // Fallback: mailto
          const subj = encodeURIComponent(`Check this out: ${ev.title}`);
          const body = encodeURIComponent(`${shareData.text}\n\n${location.href}`);
          location.href = `mailto:?subject=${subj}&body=${body}`;
        }
      });

      // Placeholder buttons
      document.getElementById("calendarBtn").addEventListener("click", ()=>{
        alert("Add to Calendar is coming soon. We’ll support Google, Apple, and Outlook.");
      });
      document.getElementById("ticketsBtn").addEventListener("click", ()=>{
        alert("Ticket purchasing is coming soon. Stay tuned!");
      });
    })();
  </script>
</body>
</html>
