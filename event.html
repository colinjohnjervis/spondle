<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Spondle â€” Event</title>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand"><span class="logo"></span><a href="index.html">Spondle</a></div>
      <div class="actions">
        <a class="btn" href="events.html">Explore Events</a>
        <a class="btn primary" href="organisers.html">For Organisers</a>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="section" id="event-section" aria-live="polite"></section>
  </main>

  <footer>
    <div class="container foot"><div>Â© <span id="y"></span> Spondle</div></div>
  </footer>

  <script>
    // Year
    document.getElementById('y').textContent = new Date().getFullYear();

    // ---- 100% self-contained data (no app.js needed) ----
    const FALLBACK = {
      "sample-1": {id:"sample-1", title:"The Harbourside Sessions", city:"Bristol", dateLabel:"12 Sep", venue:"The Louisiana", time:"19:30â€“22:30", price:"Free Entry", category:"ğŸµ Live Music", address:"Wapping Rd, Bristol", postcode:"BS1 6UA", description:"An intimate evening of live indie and alt performances on the harbourside."},
      "sample-2": {id:"sample-2", title:"Friday Night Laughs", city:"Manchester", dateLabel:"14 Sep", venue:"Northern Quarter", time:"20:00â€“22:00", price:"Â£12", category:"ğŸ­ Comedy", address:"Oldham St, Manchester", postcode:"M1 1JQ", description:"A fast-paced showcase of up-and-coming comedians and surprise headliners."},
      "sample-3": {id:"sample-3", title:"Riverside Street Food", city:"Cardiff", dateLabel:"15 Sep", venue:"Market Square", time:"11:00â€“17:00", price:"Family", category:"ğŸ Community", address:"Market Rd, Cardiff", postcode:"CF5 1QE", description:"Local vendors, global flavours. Family-friendly with live acoustic sets."}
    };

    // Parse id
    const params = new URLSearchParams(location.search);
    const id = params.get("id");
    const data = FALLBACK[id];

    // Render
    const section = document.getElementById("event-section");
    if (!data) {
      section.innerHTML = `<p class="muted">Sorry, we couldnâ€™t find that event.</p>
                           <a class="btn" href="events.html">Back to events</a>`;
    } else {
      section.innerHTML = `
        <div class="hero-card">
          <div class="eyebrow">${data.city}${data.dateLabel ? ' â€¢ '+data.dateLabel : ''}</div>
          <h1 style="margin:.2em 0 .4em">${data.title}</h1>
          <p class="tagline">${data.category || ''}</p>
        </div>

        <div class="thumb" style="margin:14px 0;border-radius:14px;">
          <span class="badge">${data.city}${data.dateLabel ? ' â€¢ '+data.dateLabel : ''}</span>${data.category || ''}
        </div>

        <div class="hero-card" id="details-card">
          <strong>Details</strong>
          <ul style="margin:10px 0 0 20px">
            ${row('Venue', data.venue)}
            ${row('Time', data.time)}
            ${row('Price', data.price)}
            ${row('Address', (data.address||'') + (data.postcode ? ', '+data.postcode : ''))}
          </ul>
          <p style="margin:12px 0 0">${data.description || ''}</p>
          <div class="cta-row">
            ${data.postcode ? `<a class="btn" target="_blank" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(data.postcode)}">Get directions</a>` : ''}
            <a class="btn" href="events.html">Back to events</a>
          </div>
          <div id="share-mount"></div>
        </div>
      `;

      // ---- Minimal inline Share Bar (no external file) ----
      const shareMount = document.getElementById('share-mount');
      const eventUrl = `${location.origin}${location.pathname}?id=${encodeURIComponent(data.id)}`;
      shareMount.appendChild(makeShareBar({ title: data.title, url: eventUrl }));
    }

    function row(label, val){ return val ? `<li><b>${label}:</b> ${val}</li>` : ''; }

    // Tiny share util (inline)
    function makeShareBar({ title, url }) {
      const bar = document.createElement('div');
      bar.className = 'sharebar';

      const nativeBtn = document.createElement('button');
      nativeBtn.className = 'btn share-native';
      nativeBtn.textContent = 'ğŸ“² Share';
      nativeBtn.addEventListener('click', async () => {
        if (navigator.share) {
          try { await navigator.share({ title, text: title, url }); } catch {}
        } else {
          // Fallback: copy
          try { await navigator.clipboard.writeText(url); toast('Link copied'); } catch {}
        }
      });

      const icons = document.createElement('div');
      icons.className = 'share-icons';
      icons.innerHTML = `
        <a class="icon" href="https://wa.me/?text=${encodeURIComponent(title)}%20${encodeURIComponent(url)}" target="_blank" rel="noopener" title="WhatsApp">ğŸŸ¢</a>
        <a class="icon" href="https://twitter.com/intent/tweet?text=${encodeURIComponent(title)}&url=${encodeURIComponent(url)}" target="_blank" rel="noopener" title="X (Twitter)">âœ–ï¸</a>
        <a class="icon" href="https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}" target="_blank" rel="noopener" title="Facebook">ğŸ“˜</a>
        <a class="icon" href="mailto:?subject=${encodeURIComponent(title)}&body=${encodeURIComponent(title)}%0A${encodeURIComponent(url)}" title="Email">âœ‰ï¸</a>
        <button class="icon" id="copyLink" title="Copy link">ğŸ”—</button>
      `;

      const toastEl = document.createElement('span');
      toastEl.className = 'share-toast';
      toastEl.hidden = true;
      toastEl.textContent = 'Link copied';

      icons.querySelector('#copyLink').addEventListener('click', async () => {
        try { await navigator.clipboard.writeText(url); toast('Link copied'); } catch {}
      });

      bar.appendChild(nativeBtn);
      bar.appendChild(icons);
      bar.appendChild(toastEl);
      return bar;

      function toast(msg){
        toastEl.textContent = msg;
        toastEl.hidden = false;
        setTimeout(()=> toastEl.hidden = true, 1200);
      }
    }
  </script>
</body>
</html>
