<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Supabase Venue Test – Full Debug</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>

<body class="bg-gray-900 text-white p-6">
  <h1 class="text-xl font-bold mb-4">Supabase Connectivity Test (Full Debug)</h1>
  <div id="log" class="text-sm text-gray-300 space-y-1"></div>

  <script>
    // Utility: append messages visibly
    const log = msg => {
      const p = document.createElement('p');
      p.textContent = msg;
      document.getElementById('log').appendChild(p);
    };

    log('🟢 Step 1: Script loaded');

    document.addEventListener('DOMContentLoaded', async () => {
      log('🟢 Step 2: DOMContentLoaded fired');

      try {
        log('🟢 Step 3: Initialising Supabase client...');
        const supabaseClient = supabase.createClient(
          'https://jvuunvnbpdfrttusgelz.supabase.co',
          'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp2dXVudm5icGRmcnR0dXNnZWx6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTcwNzE3MDYsImV4cCI6MjAxMjY0NzcwNn0.WOaUzyDNohMtPYKp7xHpE-eW6QznCdUMjvhWquw4WR8'
        );

        log('🟢 Step 4: Supabase client created. Running test query...');

        const { data, error } = await supabaseClient
          .from('venues')
          .select('id,name')
          .limit(5);

        log('🟢 Step 5: Query returned.');

        if (error) {
          log('❌ Supabase error: ' + error.message);
          return;
        }

        if (!data || data.length === 0) {
          log('⚠️ No data returned from venues table.');
          return;
        }

        log('✅ Success! Received ' + data.length + ' record(s):');
        data.forEach(v => log('• ' + v.name));

      } catch (err) {
        log('💥 Script crashed: ' + err.message);
      }

      log('🟢 Step 6: End of script.');
    });
  </script>
</body>
</html>
