<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Signing you in…</title>
  <link rel="stylesheet" href="app.v15.css">
</head>
<body class="bg-slate-900 text-slate-100">
  <main class="container mx-auto max-w-lg p-6">
    <h1 class="text-2xl font-bold mb-4">Signing you in…</h1>
    <p id="status" class="opacity-80">Completing magic-link sign in.</p>
  </main>

  <script type="module">
    import { supabase } from './auth.js';

    // Supabase will read tokens from the URL hash and establish the session.
    const { data: { session }, error } = await supabase.auth.getSession();

    const s = document.getElementById('status');
    if (error) {
      s.textContent = 'Sign in failed: ' + error.message;
    } else if (session) {
      s.textContent = 'Signed in. Redirecting…';
      // small pause so the message renders
      setTimeout(() => (window.location.href = '/index.html'), 600);
    } else {
      s.textContent = 'No session found. You can close this tab.';
    }
  </script>
</body>
</html>
